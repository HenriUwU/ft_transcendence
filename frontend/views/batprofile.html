{% load static %}
<link rel="stylesheet" href="{% static 'css/views/batprofile.css' %}">

<div class="container-fluid">
	<div id="batprofile" class="row pt-5 pb-4">
		<div class="col-md-7 d-flex flex-column justify-content-around">
			<div class="user d-flex flex-column align-self-end mb-5">
				<div class="label align-self-end px-4">
					<h3 class="username">USERNAME</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div class="name">{{ user.username }}</div>
				</div>
				<div class="label align-self-center px-4">
					<h3 class="change_username" data-bs-toggle="modal" data-bs-target="#usernameModal">CHANGE USERNAME...</h3>
				</div>
			</div>

			<div class="email d-flex flex-column align-self-end mb-2">
				<div class="label align-self-start px-4">
					<h3 class="email_address">EMAIL ADDRESS</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div class="address">{{ user.email }}</div>
				</div>
			</div>

			<div class="pass d-flex flex-column align-self-end mb-5">
				<div class="label align-self-end px-4">
					<h3 class="password">PASSWORD</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div class="pass">{{ user.password }}</div>
				</div>
				<div class="label align-self-center px-4">
					<h3 class="change_password" data-bs-toggle="modal" data-bs-target="#passwordModal">CHANGE PASSWORD...</h3>
				</div>
			</div>

			<div class="profile-pic d-flex flex-column align-self-end mb-2">
				<div class="label align-self-start px-4">
					<h3 class="profile_pic">PROFILE PIC</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div>
						<img class="pic" src="{{user.avatar.url}}"> 
					</div>
				</div>
				<div class="label align-self-center px-4">
					<h3 class="change_profile_pic" data-bs-toggle="modal" data-bs-target="#avatarModal">CHANGE PROFILE PIC...</h3>
				</div>
			</div>
		</div>
		<div class="col-md-5 d-flex flex-column justify-content-around">
			<div class="friends-list d-flex flex-column mb-2">
				<div class="label align-self-center px-4">
					<h3 class="friends_list">FRIENDS LIST</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<ul>
						{% for friend in friends %}
							<li>{{ friend.username }}</li>
						{% empty %}
							No friends yet.
						{% endfor %}
					</ul>
				</div>
			</div>
			<div class="all-users d-flex flex-column mb-2">
				<div class="label align-self-center px-4">
					<h3 class="all_users">ALL USERS</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<ul class="p-0">
						{% for user in all_users %}
							{% if not user.is_superuser %}
								{% if user not in request.user.friends.all and user != request.user %}
									<div class="users d-flex justify-content-between align-items-center mb-3 p-2">
										<div><img class="avatar" src="{{user.avatar.url}}"></div>
										<div class="name">{{user}}</div>
										<div><a href="/send_friend_request/{{user.id}}/">Add</a></div>
										<div class="status"></div>
									</div>
								<!-- <div class="users mb-3 p-2">{{user}} <a href="/send_friend_request/{{user.id}}/">send</a></div> -->
								{% endif %}
							{% endif %}
						{% endfor %}
					</ul>
				</div>
			</div>
			<div class="add-friend d-flex flex-column mb-3">
				<div class="label align-self-center px-4">
					<h3 class="friend_request">FRIEND REQUESTS</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					{% for friend_request in all_friend_request %}
						<p>{{ friend_request.from_user.username }} sent you a friend request.</p>
						<a href="/accept_friend_request/{{friend_request.id}}">Accept</a>
					{% empty %}
						<p>No friend requests.</p>
					{% endfor %}
				</div>
			</div>
		</div>
	<div class="modal fade" tabindex="-1" id="usernameModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title change_username">CHANGE USERNAME...</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="d-flex mb-3">
						<div class="me-1 current_username">Your current username is</div>
						<div><b>{{ user.username }}</b>.</div>
					</div>
					<form method="post">
						{% csrf_token %}
						{{ formUsername.as_p }}
						<button type="submit button" class="btn btn-primary update update_button">Update</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="passwordModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title change_password">CHANGE PASSWORD...</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form method="post">
						{% csrf_token %}
						{{ formPassword.as_p }}
						<button type="submit button" class="btn btn-primary update update_button">Update</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="avatarModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title change_profile_pic">CHANGE PROFILE PIC...</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form method="post" enctype="multipart/form-data">
						{% csrf_token %}
						{{ formAvatar.as_p }}
						<button type="submit button" class="btn btn-primary update update_button">Update</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="friendModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title add_friend">ADD A FRIEND</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<!-- Bouton pour supprimer l'ami -->
					<form method="post">
						{% csrf_token %}
						<input type="hidden" name="friend_id" value="{{ friend.id }}">
						<input type="hidden" name="action" value="remove">
						<button type="submit" class="btn btn-danger">Remove Friend</button>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>
