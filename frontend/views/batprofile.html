{% load static %}
<link rel="stylesheet" href="{% static 'css/views/batprofile.css' %}">

<div class="container-fluid">
	<div id="batprofile" class="row pt-5 pb-4">
		<div class="col-md-7 d-flex flex-column justify-content-around">
			<div class="username d-flex flex-column align-self-end mb-5">
				<div class="label align-self-end px-4">
					<h3><b>U</b>SERNAME</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div class="name">{{ user.username }}</div>
				</div>
				<div class="label align-self-center px-4">
					<h3 data-bs-toggle="modal" data-bs-target="#usernameModal"><b>C</b>HANGE USERNAME...</h3>
				</div>
			</div>

			<div class="email d-flex flex-column align-self-end mb-2">
				<div class="label align-self-start px-4">
					<h3><b>E</b>MAIL ADDRESS</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div class="address">{{ user.email }}</div>
				</div>
			</div>

			<div class="password d-flex flex-column align-self-end mb-5">
				<div class="label align-self-end px-4">
					<h3><b>P</b>ASSWORD</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div class="pass">{{ user.password }}</div>
				</div>
				<div class="label align-self-center px-4">
					<h3 data-bs-toggle="modal" data-bs-target="#passwordModal"><b>C</b>HANGE PASSWORD...</h3>
				</div>
			</div>

			<div class="profile-pic d-flex flex-column align-self-end mb-2">
				<div class="label align-self-start px-4">
					<h3><b>P</b>ROFILE PIC</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<div>
						<img class="pic" src="{{user.avatar.url}}"> 
					</div>
				</div>
				<div class="label align-self-center px-4">
					<h3 data-bs-toggle="modal" data-bs-target="#avatarModal"><b>C</b>HANGE PROFILE PIC...</h3>
				</div>
			</div>
		</div>
		<div class="col-md-5 d-flex flex-column justify-content-around">
			<div class="friends-list d-flex flex-column mb-5">
				<div class="label align-self-center px-4">
					<h3><b>F</b>RIENDS LIST</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<ul>
						{% for friend in friends %}
							<li>{{ friend.username }}</li>
						{% empty %}
							<li>No friends yet.</li>
						{% endfor %}
						</ul>
				</div>
			</div>
			<div class="add-friend d-flex flex-column mb-3">
				<div class="label align-self-center px-4">
					<h3><b>A</b>DD A FRIEND</h3>
				</div>
				<div class="box d-flex flex-column position-relative justify-content-center align-items-center">
					<img src="{% static 'img/dots.png' %}" class="dots-top-left">
					<img src="{% static 'img/dots.png' %}" class="dots-bottom-right">
					<h5 data-bs-toggle="modal" data-bs-target="#friendModal">Search a friend...</h5>
				</div>
			</div>
		</div>
	<div class="modal fade" tabindex="-1" id="usernameModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><b>CHANGE USERNAME...</b></h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="current-username">Your current username is <b>{{ user.username }}</b>.</div>
					<form method="post">
						{% csrf_token %}
						{{ formUsername.as_p }}
						<button type="submit button" class="btn btn-primary update">Update</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="passwordModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><b>CHANGE PASSWORD...</b></h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form method="post">
						{% csrf_token %}
						{{ formPassword.as_p }}
						<button type="submit button" class="btn btn-primary update">Update</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="avatarModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><b>CHANGE PROFILE PIC...</b></h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<form method="post" enctype="multipart/form-data">
						{% csrf_token %}
						{{ formAvatar.as_p }}
						<button type="submit button" class="btn btn-primary update">Update</button>
					</form>
				</div>
			</div>
		</div>
	</div>
	<div class="modal fade" tabindex="-1" id="friendModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><b>ADD A FRIEND</b></h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<!-- Bouton pour supprimer l'ami -->
					<form method="post">
						{% csrf_token %}
						<input type="hidden" name="friend_id" value="{{ friend.id }}">
						<input type="hidden" name="action" value="remove">
						<button type="submit" class="btn btn-danger">Remove Friend</button>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

<ul class="all_users">
	{% for user in all_users %}
	{% if not user.is_superuser %}
	{% if user not in request.user.friends.all and user != request.user %}
	{{user}} <a href="/send_friend_request/{{user.id}}/">send friend request</a>
	{% endif %}
	{% endif %}
	{% endfor %}
</ul>

{% for friend_request in all_friend_request %}
	<p>{{ friend_request.from_user.username }} sent you a friend request.</p>
	<a href="/accept_friend_request/{{friend_request.id}}">Accept</a>
{% empty %}
	<p>No friend requests.</p>
{% endfor %}
